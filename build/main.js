(()=>{var x=Object.defineProperty,G=Object.defineProperties,H=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertyNames,N=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var U=(t,e,o)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,g=(t,e)=>{for(var o in e||(e={}))O.call(e,o)&&U(t,o,e[o]);if(N)for(var o of N(e))j.call(e,o)&&U(t,o,e[o]);return t},d=(t,e)=>G(t,K(e)),q=t=>x(t,"__esModule",{value:!0});var f=(t,e)=>()=>(t&&(e=t(t=0)),e);var J=(t,e)=>{for(var o in e)x(t,o,{get:e[o],enumerable:!0})},Q=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of X(e))!O.call(t,r)&&(o||r!=="default")&&x(t,r,{get:()=>e[r],enumerable:!(n=H(e,r))||n.enumerable});return t};var Y=(t=>(e,o)=>t&&t.get(e)||(o=Q(q({}),e,1),t&&t.set(e,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);function P(t,e){let o=`${z}`;return z+=1,h[o]={handler:e,name:t},function(){delete h[o]}}function v(t,e){let o=!1;return P(t,function(...n){o!==!0&&(o=!0,e(...n))})}function F(t,e){for(let o in h)h[o].name===t&&h[o].handler.apply(null,e)}var h,z,_=f(()=>{h={},z=0;typeof window=="undefined"?figma.ui.onmessage=function([t,...e]){F(t,e)}:window.onmessage=function(t){let[e,...o]=t.data.pluginMessage;F(e,o)}});function S(t,e){if(typeof __html__=="undefined")throw new Error("No UI defined");let o=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof e=="undefined"?{}:e)};${__html__}<\/script>`;figma.showUI(o,t)}var D=f(()=>{});var k=f(()=>{_();D()});function A(t){return isNaN(Number(t))?t:`${t} ${t=="1"?"Point":"Points"}`}var I=f(()=>{});function E({votingOptions:t,storyName:e,storyDescription:o,votings:n}){return figma.widget.h(p,{direction:"vertical",width:"fill-parent"},figma.widget.h(u,{fontSize:14,fontWeight:500,fill:"#101828"},e),figma.widget.h(a,{size:4}),figma.widget.h(u,{fontSize:12,fontWeight:400,fill:"#101828"},o),figma.widget.h(a,{size:40}),figma.widget.h(p,{direction:"vertical",width:"fill-parent",spacing:8},figma.widget.h(ot,{votings:[d(g({},n[0]),{userId:1111,votedFor:"128"}),d(g({},n[0]),{userId:22,votedFor:"64"}),d(g({},n[0]),{userId:5,votedFor:"128"})],votingOptions:t})),figma.widget.h(a,{size:40}),figma.widget.h(et,{votings:[d(g({},n[0]),{userId:1111,votedFor:"128"}),d(g({},n[0]),{userId:22,votedFor:"64"}),d(g({},n[0]),{userId:5,votedFor:"128"})],votingOptions:t}))}function et({votingOptions:t,votings:e}){let o=e.length,n=(()=>{switch(t.kind){case"numeric":return"\xF8 "+(Array.from(e.groupBy(r=>r.votedFor).values()).map(r=>Number(r[0].votedFor)*r.length).reduce((r,s)=>r+s,0)/o).toFixed(1)+" Points";case"categorical":return}})();return figma.widget.h(p,{direction:"horizontal",horizontalAlignItems:"center",width:"fill-parent",cornerRadius:8},figma.widget.h(p,{direction:"horizontal",verticalAlignItems:"center",width:"hug-contents",height:34,fill:"#ECFDF3",cornerRadius:8,padding:{vertical:8,horizontal:16}},figma.widget.h(u,{fontSize:12,fontWeight:400,fill:"#054F31"},`${o} ${o==1?"Vote":"Votes"}`),n?figma.widget.h(p,{direction:"horizontal",verticalAlignItems:"center",width:"hug-contents"},figma.widget.h(a,{size:10}),figma.widget.h(V,{height:18,width:1,fill:"#D1FADF"}),figma.widget.h(a,{size:10}),figma.widget.h(u,{fontSize:12,fontWeight:400,fill:"#054F31"},n)):void 0))}function ot({votingOptions:t,votings:e}){let o=Array.from(e.groupBy(r=>r.votedFor,new Map(t.options.map(r=>[r,[]]))).entries()).filter(([r,s])=>s.length>0),n=e.length;return o.map(([r,s])=>figma.widget.h(p,{key:`${r}`,direction:"vertical",verticalAlignItems:"center",width:288,height:"hug-contents",spacing:8},figma.widget.h(p,{verticalAlignItems:"end",spacing:0,width:"fill-parent"},figma.widget.h(u,{fontSize:14,fontWeight:600,fill:"#101828"},A(r)),figma.widget.h(V,{height:1,width:"fill-parent"}),nt(s)),figma.widget.h(rt,{votes:s.length,totalVotes:n,length:288}),figma.widget.h(u,{fontSize:12,fontWeight:400,fill:"#101828",width:"fill-parent",horizontalAlignText:"right"},s.length," ",s.length==1?"Vote":"Votes")))}function nt(t){let e=[];for(let o=0;o<t.length;o+=W)e.push(t.slice(o,o+W));return figma.widget.h(p,{direction:"vertical",spacing:8},e.map((o,n)=>figma.widget.h(p,{key:`row_${n}`,direction:"horizontal",horizontalAlignItems:"end",spacing:8,width:"fill-parent"},o.map(r=>figma.widget.h(w,{key:`avatar_${r}`,photoUrl:r.userPhotoUrl,opacity:1})))))}function a({size:t}){return figma.widget.h(V,{width:t,height:t})}function w({photoUrl:t,opacity:e,key:o}){return figma.widget.h(tt,{key:o,width:24,height:24,src:t,cornerRadius:24,opacity:e})}function T({text:t,onClick:e}){return figma.widget.h(p,{width:"fill-parent",height:44,cornerRadius:8,fill:"#C8CCE5",onClick:()=>new Promise(e)},figma.widget.h(u,{verticalAlignText:"center",horizontalAlignText:"center",width:"fill-parent",lineHeight:44,fontSize:14,fontWeight:600,fill:"#000E52"},t))}var Z,p,V,u,R,tt,Ut,zt,Pt,Ft,_t,Dt,kt,Rt,Et,rt,W,b=f(()=>{I();Array.prototype.groupBy=function(t,e){let o=e!=null?e:new Map;return this.reduce((n,r)=>{var i;let s=t(r);return n.set(s,((i=n.get(s))!=null?i:[]).concat([r]))},o)};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};({widget:Z}=figma),{AutoLayout:p,Frame:V,Text:u,Rectangle:R,Image:tt,SVG:Ut,Ellipse:zt,useSyncedState:Pt,useSyncedMap:Ft,usePropertyMenu:_t,useEffect:Dt,useWidgetId:kt,register:Rt,waitForTask:Et}=Z;rt=({votes:t,totalVotes:e,length:o})=>figma.widget.h(V,{width:o,height:8,cornerRadius:8},figma.widget.h(R,{width:o,height:8,fill:"#F9FAFB"}),e>0?figma.widget.h(R,{width:t/e*o,height:8,cornerRadius:8,fill:"#717BBC"}):null),W=6});var B={};J(B,{default:()=>lt});function lt(){C.register(gt)}function gt(){let[t,e]=it("votingState",M),o=st("userVote");ct(()=>{t.votingState=="Revealed"&&figma.closePlugin()});let n={itemType:"action",tooltip:"Reveal",propertyName:"reveal"},r={itemType:"action",tooltip:"Reset",propertyName:"reset"},s=(()=>{switch(t.votingState){case"InProgress":return[r,n];case"Revealed":return[r];default:return[]}})();return at(s,({propertyName:i})=>{switch(i){case"reveal":t.votingState=="InProgress"&&e({votingState:"Revealed",votingOptions:t.votingOptions,storyName:t.storyName,storyDescription:t.storyDescription});break;case"reset":e(M),o.keys().forEach(c=>o.delete(c));break}}),figma.widget.h(y,{direction:"vertical",verticalAlignItems:"center",fill:"#FFFFFF",width:320,cornerRadius:8,effect:{type:"drop-shadow",color:{r:0,g:0,b:0,a:.2},offset:{x:0,y:2},blur:3,spread:2},padding:{vertical:16,horizontal:16}},(()=>{switch(t.votingState){case"NotStarted":return figma.widget.h(dt,{onClickStart:()=>{S({width:240,height:344},{name:"INIT_VOTING_DATA"}),v("SET_VOTING",(i,c,l)=>{t.votingState=="NotStarted"&&e({votingState:"InProgress",votingOptions:i,storyName:c,storyDescription:l}),figma.closePlugin()})}});case"InProgress":return figma.widget.h(ut,d(g({},t),{votedUserIds:o.values().map(i=>i.userId),onClickVote:()=>{var i;S({width:240,height:344},{name:"VOTING_DATA",votingOptions:t.votingOptions,storyDescription:t.storyDescription,storyName:t.storyName,votedFor:(i=o.get(figma.currentUser.sessionId.toString()))==null?void 0:i.votedFor}),v("SET_VOTE",c=>{if(t.votingState=="InProgress"){let l=figma.currentUser;o.set(l.sessionId.toString(),{userId:l.sessionId,userPhotoUrl:l.photoUrl,votedFor:c}),figma.notify(`${A(c)} it is. ${pt.random()}`)}figma.closePlugin()})}}));case"Revealed":return figma.widget.h(E,{votings:o.values(),votingOptions:t.votingOptions,storyName:t.storyName,storyDescription:t.storyDescription});default:return}})())}function dt({onClickStart:t}){return figma.widget.h(y,{direction:"vertical",horizontalAlignItems:"center",width:"fill-parent"},figma.widget.h(m,{fontSize:18,fontWeight:600,horizontalAlignText:"center",fill:"#000000"},"Scrum-A-Lot"),figma.widget.h(a,{size:4}),figma.widget.h(m,{fontSize:14,fontWeight:400,horizontalAlignText:"center",fill:"#667085"},"Start with creating a story and let your"),figma.widget.h(m,{fontSize:14,fontWeight:400,horizontalAlignText:"center",fill:"#667085"},"team estimate the effort."),figma.widget.h(a,{size:24}),figma.widget.h(T,{text:"Create Story",onClick:t}))}function ut({storyName:t,storyDescription:e,votedUserIds:o,onClickVote:n}){let r=[],s=figma.activeUsers.map(i=>{var c;return{photoUrl:(c=i.photoUrl)!=null?c:"",hasVoted:!!o.find(l=>l==i.sessionId)}});for(let i=0;i<s.length;i+=L)r.push(s.slice(i,i+L));return figma.widget.h(y,{direction:"vertical",width:"fill-parent"},figma.widget.h(m,{fontSize:14,fontWeight:500,fill:"#101828"},t),figma.widget.h(a,{size:4}),figma.widget.h(m,{fontSize:12,fontWeight:400,fill:"#101828"},e),figma.widget.h(a,{size:40}),figma.widget.h(y,{direction:"vertical",horizontalAlignItems:"start",width:"fill-parent",spacing:8},r.map((i,c)=>figma.widget.h(y,{key:`row_${c}`,direction:"horizontal",horizontalAlignItems:"start",spacing:8,width:"fill-parent"},i.map(l=>figma.widget.h(w,{key:`avatar_${l}`,photoUrl:l.photoUrl,opacity:l.hasVoted?1:.3}))))),figma.widget.h(a,{size:40}),figma.widget.h(m,{fontSize:12,fontWeight:400,fill:"#101828"},`${o.length} ${o.length==1?"Vote":"Votes"}`),figma.widget.h(a,{size:8}),figma.widget.h(T,{text:"Vote",onClick:n}))}var C,y,Xt,m,jt,qt,Jt,Qt,it,st,at,ct,Yt,Zt,te,pt,M,L,$=f(()=>{k();I();b();({widget:C}=figma),{AutoLayout:y,Frame:Xt,Text:m,Rectangle:jt,Image:qt,SVG:Jt,Ellipse:Qt,useSyncedState:it,useSyncedMap:st,usePropertyMenu:at,useEffect:ct,useWidgetId:Yt,register:Zt,waitForTask:te}=C;pt=["Great choice!","Dy-na-mite.","The only possible choice tbh.","Excellent choice, citizen.","\u{1F4AA}\u{1F525}","Sweet decision making, worker."],M={votingState:"NotStarted"};L=6});var ft={"src/main.tsx--default":($(),Y(B)).default},mt="src/main.tsx--default";ft[mt]();})();
